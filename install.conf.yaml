- defaults:
    link:
      relink: true

- clean: ['~']

- flatpak:
    - org.telegram.desktop
    - com.spotify.Client

- link:
    ~/.gitconfig: config/gitconfig
    ~/.gitignore: config/gitignore
    ~/.zshrc: config/zshrc
    ~/.rsync_skip: config/rsync_skip
    ~/.config/alacritty/alacritty.yml: config/alacritty.yml
    ~/.config/starship.toml: config/starship.toml
    ~/.config/Code/User/settings.json: vscode/settings.json
    ~/.config/Code/User/keybindings.json: vscode/keybindings.json
    ~/.config/Code/User/snippets: vscode/snippets

- shell:
  - command: >
      code
      --install-extension ms-python.vscode-pylance
      --install-extension wmaurer.change-case
      --install-extension teabyii.ayu
      --install-extension ms-azuretools.vscode-docker
      --install-extension mikestead.dotenv
      --install-extension editorconfig.editorconfig
      --install-extension florinpatrascu.vscode-elixir-snippets
      --install-extension JakeBecker.elixir-ls
      --install-extension tamasfe.even-better-toml
      --install-extension tombonnike.vscode-status-bar-format-toggle
      --install-extension mhutchie.git-graph
      --install-extension eamodio.gitlens
      --install-extension golang.go
      --install-extension hashicorp.terraform
      --install-extension ms-python.isort
      --install-extension ivory-lab.jenkinsfile-support
      --install-extension wholroyd.jinja
      --install-extension ms-vsliveshare.vsliveshare
      --install-extension equinusocio.vsc-material-theme-icons
      --install-extension phoenixframework.phoenix
      --install-extension esbenp.prettier-vscode
      --install-extension ms-python.python
      --install-extension timonwong.shellcheck
      --install-extension fivethree.vscode-svelte-snippets
      --install-extension svelte.svelte-vscode
      --install-extension tabnine.tabnine-vscode
      --install-extension bradlc.vscode-tailwindcss
      --install-extension ms-vscode.test-adapter-converter
      --install-extension hbenl.vscode-test-explorer
      --install-extension enkia.tokyo-night
      --install-extension shardulm94.trailing-spaces
      --install-extension bbenoist.vagrant
      --install-extension redhat.vscode-xml
      --install-extension redhat.vscode-yaml
    stderr: true
    quiet: true
    description: install vscode extensions

- shell:
  - command: |
      if [ ! -f $HOME/.ssh/id_ed25519 ]; then
        ssh-keygen -o -a 100 -t ed25519 -N '' -f $HOME/.ssh/id_ed25519
      fi
    stderr: true
    quiet: true
    description: generate ssh key

  - command: |
      if [ ! -d $HOME/.asdf ]; then
        git clone https://github.com/asdf-vm/asdf.git $HOME/.asdf --branch v0.12.0

        $HOME/.asdf/bin/asdf plugin add nodejs https://github.com/asdf-vm/asdf-nodejs.git
        $HOME/.asdf/bin/asdf plugin-add terraform https://github.com/asdf-community/asdf-hashicorp.git
        $HOME/.asdf/bin/asdf plugin-add python https://github.com/asdf-community/asdf-python.git
        $HOME/.asdf/bin/asdf plugin add erlang https://github.com/asdf-vm/asdf-erlang.git
        $HOME/.asdf/bin/asdf plugin-add elixir https://github.com/asdf-vm/asdf-elixir.git
      fi
    stderr: true
    quiet: true
    description: install asdf

  - command: curl -sS https://starship.rs/install.sh | sh
    stderr: true
    stdout: true
    # quiet: true
    description: install starship

  - command: chsh -s /bin/zsh
    stdin: true
    stderr: true
    quiet: true
    description: change default shell

  - command: |
      if [ ! -d $HOME/.zprezto ]; then
        git clone --recursive https://github.com/sorin-ionescu/prezto.git "$HOME/.zprezto"
      fi

      zsh -c 'setopt EXTENDED_GLOB
      for rcfile in $HOME/.zprezto/runcoms/^README.md(.N); do
        ln -s "$rcfile" "$HOME/.${rcfile:t}" || true
      done'
    stderr: true
    quiet: true
    description: setup prezto
